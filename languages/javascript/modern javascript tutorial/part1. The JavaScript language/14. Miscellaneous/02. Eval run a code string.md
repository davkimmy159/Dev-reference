`Eval` <sub>(문자열 코드 실행)</sub>
========================

##### `eval` <sub>(내장 함수)</sub>
- 문자열 형태 코드 실행

##### 문법
```javascript
let result = eval(code);
```
- 예시
```javascript
let code = 'alert("Hello")';
eval(code); // Hello
```

##### 긴 문자열 내 포함 요소
- 줄 바꿈
- 함수 선언
- 변수
- 기타 등등

##### 마지막 구문 결과 == `eval` 결과
```javascript
let value = eval('1+1');
alert(value); // 2

let value = eval('let i = 0; ++i');
alert(value); // 1
```

##### `eval` 로 둘러싼 코드
- 현재 렉시컬 환경에서 실행
  - 외부 변수 접근 가능
```javascript
let a = 1;

function f() {
  let a = 2;

  eval('alert(a)'); // 2
}

f();
```

##### 외부 변수 변경
```javascript
let x = 5;
eval("x = 10");
alert(x); // 10, 변경된 값
```

##### 엄격 모드 `eval`
- 자체 렉시컬 환경 보유
- `eval` 내부 선언 함수 · 변수
  - 외부에서 접근 X
```javascript
// 참고 : 실행 가능한 모든 예시
// - 'use strict' 적용

eval("let x = 5; function f() {}");

alert(typeof x); // undefined (없는 변수)
alert(typeof f); // undefined (없는 함수)
```

##### `"use strict"` 미적용 시 `eval`
- 자체 렉시컬 환경 X
  - 외부 `x` · `f` 접근 가능

### `eval` 사용하기
- 모던 프로그래밍
  - 드물게 사용
  - _"eval is evil"_
- 과거 JS
  - 기능 부실
- 현재 JS
  - 강력한 기능 보유

#### `eval` : 외부 변수 접근 시 부작용 발생

##### 코드 압축기
- JS 파일 압축
  - 지역 변수명 축약

##### `eval` 내부 코드 접근 가능 모든 변수
- 이름 변경 X
  - 코드 압축률에 부정적인 영향

##### `eval` 내부에서 외부 지역 변수 사용
- 코드 유지 보수 난이도 ↑
  - 좋지 않은 프로그래밍 관습

#### 문제 예방법

##### `eval` 로 감싼 코드
1. 외부 변수 미사용 시
    - `eval` X
    - `window.eval( … )`
- `eval` 내 코드
  - 전역 스코프 실행
```javascript
let x = 1;
{
  let x = 5;
  window.eval('alert(x)'); // 1 (전역 변수)
}
```
2. 지역 변수 사용 시
    - `eval` X
    - `new Function` <sub>(문자열 코드 전달)</sub>
- 새 전역 스코프 함수 생성
  - 지역 변수 접근 X
- 권장 방법
  - 지역 변수 직접 접근 X
  - 인수 전달 <sub>(훨씬 명확)</sub>
```javascript
let f = new Function('a', 'alert(a)');

f(5); // 5
```

<br />

## 요약
`eval(code)`을 호출하면 문자열 형태의 `code`가 실행되는데 이때 마지막 구문의 결과가 반환됩니다.
- 모던 자바스크립트엔 `eval`을 대체할 수 있는 문법이 많기 때문에, 모던 자바스크립트를 사용하는 코드에선 `eval`을 잘 사용하지 않습니다.
- `eval`을 이용해 만든 코드는 외부 지역 변수에 접근할 수 있는데, 이는 좋지 않은 방법입니다.
- 전역 스코프에서 `eval`을 사용하지 말고, `window.eval(code)`을 이용하세요.
- 외부 스코프에 있는 데이터가 필요하다면 `new Function`의 인수에 코드를 전달해 사용하시면 됩니다.

<br />

## <img class="icon" src="../../images/commons/icons/circle-check-solid.svg" /> 과제

### Eval 계산기
산술 표현식을 입력받는 프롬프트 대화상자를 표시하고 결과를 반환하는 계산기를 만들어봅시다.

입력한 표현식이 정확한 지 확인할 필요는 없고, 결과를 평가하고 반환하기만 하면 됩니다.

<br />

<img class="icon" src="../../images/commons/icons/circle-answer.svg" />

산술 표현식을 계산하기 위해 `eval`을 사용해봅시다.
```javascript
let expr = prompt("산술 표현식을 입력하시겠습니까?", '2*3+2');

alert( eval(expr) );
```

사용자는 텍스트 또는 코드를 입력할 수 있습니다.

문자열을 산술 표현식만 입력하도록 제한하여 안전하게 eval로 실행하기 위해, 정규 표현식을 사용하여 `expr`을 검사하면 숫자와 연산자만 포함하게 됩니다.
