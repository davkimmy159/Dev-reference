`File` · `FileReader`
===================

### [`File`](https://www.w3.org/TR/FileAPI/#dfn-file) <sub>(객체)</sub>

##### `Blob` <sub>(객체)</sub> 상속
- 파일 시스템 관련 기능 추가

#### `File` <sub>(객체)</sub> 얻는 방법

##### 1. 생성자 <sub>(`Blob` 객체 유사)</sub>
```javascript
new File(fileParts, fileName, [options])
```
- `fileParts` <sub>(배열)</sub>
  - `Blob` <sub>(객체)</sub>
  - `BufferSource` <sub>(뷰 객체)</sub>
  - 문자열
- `fileName` <sub>(문자열)</sub>
  - 파일명
- `options` <sub>(객체)</sub>
  - `lastModified`
    - 마지막 수정 시간 <sub>(타임스탬프)</sub>

##### 2. 기타 방법 <sub>(OS 정보 받음)</sub>
- `<input type="file">` <sub>(요소)</sub>
- 드래그 앤 드롭
- 타 브라우저 인터체이스

##### 추가 프로퍼티
- `name`
  - 파일명
- `lastModified`
  - 마지막 수정 시간 <sub>(타임스탬프)</sub>

##### `File` <sub>(객체)</sub> 얻기
- `<input type="file">` <sub>(요소)</sub>
```html
<input type="file" onchange="showFile(this)" />

<script>
function showFile(input) {
  let file = input.files[0];

  // ex) my.png
  alert(`File name: ${file.name}`);

  // ex) 1552830408824
  alert(`Last modified: ${file.lastModified}`);
}
</script>
```

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **주의**


##### `files` <sub>(프로퍼티)</sub>
- 유사 배열 객체

##### `input` <sub>(요소)</sub>
- 다수 파일 선택 가능
- `files` <sub>(프로퍼티)</sub>
  - 유사 배열 객체

<br />

### [`FileReader`](https://www.w3.org/TR/FileAPI/#dfn-filereader) <sub>(객체)</sub>

##### 용도
- `Blob` · `File` <sub>(객체)</sub> 데이터 읽기
- 이벤트 통해 데이터 전달
  - 디스크 읽기 시간 소모 大

##### 생성자
```javascript
// 인수 X
let reader = new FileReader();
```

#### 주 메서드

readAsArrayBuffer(blob) – read the data in binary format ArrayBuffer.

##### `readAsArrayBuffer(blob)`
- 이진 포멧으로 데이터 읽기
  - 이진 포맷 <sub>(`ArrayBuffer` 객체)</sub>

##### `readAsText(blob, [encoding])`
- read the data as a text string with the given encoding (`utf-8` by default).

##### `readAsDataURL(blob)`
- read the binary data and encode it as base64 data url.

##### `abort()`
- cancel the operation.

The choice of `read[*]` method depends on which format we prefer, how we're going to use the data.
- `readAsArrayBuffer` – for binary files, to do low-level binary operations. For high-level operations, like slicing, `File` inherits from `Blob`, so we can call them directly, without reading.
- `readAsText` – for text files, when we'd like to get a string.
- `readAsDataURL` – when we'd like to use this data in `src` for `img` or another tag. There's an alternative to reading a file for that, as discussed in chapter Blob: `URL.createObjectURL(file)`.

As the reading proceeds, there are events:
- `loadstart` – loading started.
- `progress` – occurs during reading.
- `load` – no errors, reading complete.
- `abort` – `abort()` called.
- `error` – error has occurred.
- `loadend` – reading finished with either success or failure.

When the reading is finished, we can access the result as:
- `reader.result` is the result (if successful)
- `reader.error` is the error (if failed).

The most widely used events are for sure `load` and `error`.

Here's an example of reading a file:
```html
<input type="file" onchange="readFile(this)">

<script>
function readFile(input) {
  let file = input.files[0];

  let reader = new FileReader();

  reader.readAsText(file);

  reader.onload = function() {
    console.log(reader.result);
  };

  reader.onerror = function() {
    console.log(reader.error);
  };

}
</script>
```

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **`FileReader` for blobs**

As mentioned in the chapter Blob, `FileReader` can read not just files, but any blobs.

We can use it to convert a blob to another format:
- `readAsArrayBuffer(blob)` – to `ArrayBuffer`,
- `readAsText(blob, [encoding])` – to string (an alternative to `TextDecoder`),
- `readAsDataURL(blob)` – to base64 data url.

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **`FileReaderSync` is available inside Web Workers**

For Web Workers, there also exists a synchronous variant of `FileReader`, called [`FileReaderSync`](https://www.w3.org/TR/FileAPI/#FileReaderSync).

Its reading methods `read[*]` do not generate events, but rather return a result, as regular functions do.

That's only inside a Web Worker though, because delays in synchronous calls, that are possible while reading from files, in Web Workers are less important. They do not affect the page.

<br />

## 요약
`File` objects inherit from `Blob`.

In addition to `Blob` methods and properties, `File` objects also have `name` and `lastModified` properties, plus the internal ability to read from filesystem. We usually get `File` objects from user input, like `<input>` or Drag'n'Drop events (`ondragend`).

FileReader objects can read from a file or a blob, in one of three formats:
- String (`readAsText`).
- `ArrayBuffer` (`readAsArrayBuffer`).
- Data url, base-64 encoded (`readAsDataURL`).

In many cases though, we don't have to read the file contents. Just as we did with blobs, we can create a short url with `URL.createObjectURL(file) `and assign it to `<a>` or `<img>`. This way the file can be downloaded or shown up as an image, as a part of canvas etc.

And if we're going to send a `File` over a network, that's also easy: network API like `XMLHttpRequest` or `fetch` natively accepts `File` objects.
