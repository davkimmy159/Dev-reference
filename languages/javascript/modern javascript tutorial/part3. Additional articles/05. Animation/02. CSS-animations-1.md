CSS 애니메이션
============

### CSS 트랜지션

##### 등장 배경
- 애니메이션 관련 프로퍼티 정의
- 프로퍼티 값 통해 애니메이션 효과 정의
  - 값 변경 → 해당 값 애니메이션 표현

##### `background-color` 변경
- 3초 동안 서서히 변화
```css
.animated {
  transition-property: background-color;
  transition-duration: 3s;
}
```

##### 버튼 클릭 시 버튼 배경색 변화
```html
<button id="color">클릭</button>

<style>
  #color {
    transition-property: background-color;
    transition-duration: 3s;
  }
</style>

<script>
  color.onclick = function() {
    this.style.backgroundColor = 'red';
  };
</script>
```

![css-transition-1-before](../../images/03/05/02/css-transition-1-before.png)

![css-transition-1-after](../../images/03/05/02/css-transition-1-after.png)

##### CSS 트랜지션 프로퍼티
- `transition-property`
- `transition-duration`
- `transition-timing-function`
- `transition-delay`
- `transition` <sub>(공통)</sub>
  - 한 번에 선언

##### `transition` 선언
- `font-size` 3초 변화
- `color` 2초 변화
```html
<button id="growing">클릭</button>

<style>
  #growing {
    transition: font-size 3s, color 2s;
  }
</style>

<script>
  growing.onclick = function() {
    this.style.fontSize = '36px';
  this.style.color = 'red';
};
</script>
```

![css-transition-2-before](../../images/03/05/02/css-transition-2-before.png)

![css-transition-2-after](../../images/03/05/02/css-transition-2-after.png)

### `transition-property`

##### 애니메이션 효과 적용 대상 프로퍼티 목록 정의
- `left`
- `margin-left`
- `height`
- `color`
- 기타 등등

###### 모든 프로퍼티 적용 가능 X
- [흔히 사용되는 대다수 프로퍼티](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_animated_properties)
  - 애니메이션 효과 적용 가능

### `transition-duration`

##### 애니메이션 효과 지속 시간 설정
- [CSS 시간 형식](https://www.w3.org/TR/css3-values/#time) 준수
  - 초 단위 <sub>(`s`)</sub>
  - 밀리초 단위 <sub>(`ms`)</sub>
  - 기타 등등

### `transition-delay`
`transition-delay` 프로퍼티엔 애니메이션 효과가 시작되기 전에 얼마만큼의 지연시간을 줄지 설정합니다. `transition-delay` 값을 `1s`로 설정하면 애니메이션 효과가 1초 후에 나타납니다.

`transition-delay`엔 음수 값도 넣을 수 있습니다. 값이 음수일 땐 애니메이션 효과가 중간부터 나타납니다. `transition-duration`을 `2s`, 지연시간을 `-1s`로 설정하면 애니메이션 효과는 1초가 지난 후 1초 동안 지속됩니다.

`translate` <sub>(CSS 프로퍼티)</sub> 와 지금까지 배운 내용을 사용해 `0`부터 `9`까지가 화면에 자연스럽게 나타나도록 해봅시다.

##### 결과

![transition-duration-1-before](../../images/03/05/02/transition-duration-1-before.png)

![transition-duration-1-during](../../images/03/05/02/transition-duration-1-during.png)

![transition-duration-1-after](../../images/03/05/02/transition-duration-1-after.png)

```html
<!-- index.html -->
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  아래 숫자를 클릭하세요.

  <div id="digit"><div id="stripe">0123456789</div></div>

  <script src="script.js"></script>
</body>

</html>
```
```javascript
/* script.js */
stripe.onclick = function() {
  stripe.classList.add('animate');
};
```
```css
/* style.css */
#digit {
  width: .5em;
  overflow: hidden;
  font: 32px monospace;
  cursor: pointer;
}

#stripe {
  display: inline-block
}

#stripe.animate {
  transform: translate(-90%);
  transition-property: transform;
  transition-duration: 9s;
  transition-timing-function: linear;
}
```

참고로 숫자를 좌측으로 이동시키기 위해 `transform` 프로퍼티에 `translate(-90%)`를 넣었습니다.
```css
#stripe.animate {
  transform: translate(-90%);
  transition-property: transform;
  transition-duration: 9s;
}
```

숫자를 클릭하면 자바스크립트가 실행되면서 숫자가 들어 있는 요소(stripe)에 `animate` 클래스가 추가되고 애니메이션 효과가 나타납니다.
```javascript
stripe.classList.add('animate');
```

이번엔 `transition-delay`에 음수를 써서 예시를 약간 변형해봅시다. 현재 시각을 기준으로 '초'를 추출하고, 이 값에 마이너스 기호를 붙여서 `transition-delay` 값으로 지정하면 현재 초를 기준으로 숫자가 나타나고, 애니메이션 효과가 적용되는 것을 확인할 수 있습니다.

직접 숫자를 클릭해보세요. 현재 날짜가 2020년 9월 12일 오후 12시 17분 8초라면, 숫자 8부터 스르륵 이동합니다.

##### 결과

![transition-duration-2-before](../../images/03/05/02/transition-duration-2-before.png)

![transition-duration-2-during](../../images/03/05/02/transition-duration-2-during.png)

![transition-duration-2-after](../../images/03/05/02/transition-duration-2-after.png)

```html
<!-- index.html -->
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  아래 숫자를 클릭하세요.
  <div id="digit"><div id="stripe">0123456789</div></div>

  <script src="script.js"></script>
</body>
</html>
```
```javascript
/* script.js */
stripe.onclick = function() {
  let sec = new Date().getSeconds() % 10;
  stripe.style.transitionDelay = '-' + sec + 's';
  stripe.classList.add('animate');
};
```
```css
/* style.css */
#digit {
  width: .5em;
  overflow: hidden;
  font: 32px monospace;
  cursor: pointer;
}

#stripe {
  display: inline-block
}

#stripe.animate {
  transform: translate(-90%);
  transition-property: transform;
  transition-duration: 9s;
  transition-timing-function: linear;
}
```

사용한 코드는 아래와 같습니다.
```javascript
stripe.onclick = function() {
  let sec = new Date().getSeconds() % 10;

  // sec가 3이라면 transitionDelay 값이 -3s가 되어 3부터 애니메이션 효과가 적용됩니다.
  stripe.style.transitionDelay = '-' + sec + 's';
  stripe.classList.add('animate');
};
```

### `transition-timing-function`
`transition-timing-function` 프로퍼티를 사용해 timing 함수를 만들면 시간에 따라 애니메이션 효과를 어떻게 분배할지를 설정할 수 있습니다. 애니메이션 효과가 초반엔 천천히 나타나다가 나중엔 빠르게 나타나게 할 수 있고, 물론 이 반대도 가능합니다.

처음 이 프로퍼티를 접하면 애니메이션 프로퍼티 중 가장 복잡한 프로퍼티 같다고 느낄 수 있습니다. 그렇지만 시간을 조금 투자해 학습하면 매우 간단한 프로퍼티라는 생각이 들 겁니다.

`transition-timing-function` 프로퍼티 값엔 베지어 곡선(bezier curve)이나 단계(step)가 올 수 있습니다. 먼저 사용 빈도가 높은 베지어 곡선부터 알아봅시다.

#### 베지어 곡선
`transition-timing-function`엔 조절점이 4개면서 아래 조건을 만족하는 베지어 곡선을 지정할 수 있습니다.
1. 첫 번째 조절점: `(0,0)`
2. 마지막 조절점: `(1,1)`
3. 중간 조절점들: `x`가 `0`과 `1` 사이에 있어야 함. `y`엔 제약이 없음

CSS에선 베지어 곡선을 `cubic-bezier(x2, y2, x3, y3)`형태로 정의합니다. 규칙에 따라 첫 번째 조절점은 `(0,0)`, 네 번째 조절점은 `(1,1)`로 고정되므로 두 번째와 세 번째 조절점만 설정하면 됩니다.

조절점을 변경해 만든 베지어 곡선을 사용해 정의한 timing 함수는 시간이 지남에 따라 얼마나 빠르게 애니메이션 효과가 나타나게 할지를 보여줍니다.
- `x`축은 시간이 됩니다. `0`은 애니메이션 시작하는 시간, `1`은 끝나는 시간을 나타냅니다.
- `y`축은 프로세스 완성 정도를 나타냅니다. `0`은 프로퍼티 시작 값, `1`은 최종값을 나타냅니다.

가장 간단한 timing 함수를 적용하면 애니메이션 효과가 일정한 속도로 나타납니다. `cubic-bezier(0, 0, 1, 1)`를 사용해 기울기가 `1`인 직선형 함수를 만들어봅시다.

베지어 곡선이 이렇게 그려지겠죠.

![bezier-linear](../../images/03/05/02/bezier-linear.svg)

보시다시피 그냥 직선입니다. 시간(`x`)이 지나면서 애니메이션의 완성도(`y`)가 `0`에서 `1`로 꾸준히 올라갑니다.

이제 아래 기차를 클릭해, 기차가 일정한 속도로 좌측에서 우측으로 이동하게 해봅시다.

##### 결과

![transition-timing-function-1-before](../../images/03/05/02/transition-timing-function-1-before.png)

![transition-timing-function-1-during](../../images/03/05/02/transition-timing-function-1-during.png)

![transition-timing-function-1-after](../../images/03/05/02/transition-timing-function-1-after.png)

```html
<!-- index.html -->
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <img class="train" src="https://js.cx/clipart/train.gif" onclick="this.style.left='450px'">

</body>

</html>
```
```css
/* style.css */
.train {
  position: relative;
  cursor: pointer;
  width: 177px;
  height: 160px;
  left: 0;
  transition: left 5s cubic-bezier(0, 0, 1, 1);
}
```

실제 사용한 스타일은 다음과 같습니다.
```css
.train {
  left: 0;
  transition: left 5s cubic-bezier(0, 0, 1, 1);
  /* left 속성값(450px)은 자바스크립트에서 설정함 */
}
```

이제 기차가 점점 느리게 이동하도록 만들어봅시다.

다른 베지어 곡선 `cubic-bezier(0.0, 0.5, 0.5 ,1.0)`을 사용해서 말이죠.

새로운 베지어 곡선은 다음과 같습니다.

![train-curve](../../images/03/05/02/train-curve.svg)

그래프에서 볼 수 있듯이 프로세스는 초반에 빠르게 진행되다가 점점 느려질 겁니다.

기차를 클릭해 실제 timing 함수가 어떻게 적용되었는지 확인해봅시다.

##### 결과

![transition-timing-function-2-before](../../images/03/05/02/transition-timing-function-2-before.png)

![transition-timing-function-2-during](../../images/03/05/02/transition-timing-function-2-during.png)

![transition-timing-function-2-after](../../images/03/05/02/transition-timing-function-2-after.png)

```html
<!-- index.html -->
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <img class="train" src="https://js.cx/clipart/train.gif" onclick="this.style.left='450px'">

</body>

</html>
```
```css
/* style.css */
.train {
  position: relative;
  cursor: pointer;
  width: 177px;
  height: 160px;
  left: 0px;
  transition: left 5s cubic-bezier(0.0, 0.5, 0.5, 1.0);
}
```

CSS:
```css
.train {
  left: 0;
  transition: left 5s cubic-bezier(0, .5, .5, 1);
    /* left 속성값(450px)은 자바스크립트에서 설정함 */
}
```

직접 베지어 곡선을 만드는 것 말고, 내장 곡선을 사용할 수도 있습니다. 내장 곡선엔 `linear`, `ease`, `ease-in`, `ease-out`, `ease-in-out` 등이 있습니다.

`linear`는 위에서 본 직선 형태의 timing 함수를 쓸 때 사용된 `cubic-bezier(0, 0, 1, 1)`와 동일한 효과를 줍니다.

각 내장 곡선에 대응하는 베지어 곡선은 다음과 같습니다.

|ease*|ease-in|ease-out|ease-in-out|
|---|---|---|---|
|`(0.25, 0.1, 0.25, 1.0)`|`(0.42, 0, 1.0, 1.0)`|`(0, 0, 0.58, 1.0)`|`(0.42, 0, 0.58, 1.0)`|
|![ease](../../images/03/05/02/ease.svg)|![ease-in](../../images/03/05/02/ease-in.svg)|![ease-out](../../images/03/05/02/ease-out.svg)|![ease-in-out](../../images/03/05/02/ease-in-out.svg)|

`*`로 표시한 내장 곡선 `ease`는 timing 함수가 없을 때 기본값으로 사용됩니다.

이제 `ease-out`을 사용해 기차가 점점 느려지도록 해봅시다.
```css
.train {
  left: 0;
  transition: left 5s ease-out;
  /* transition: left 5s cubic-bezier(0, .5, .5, 1); */
}
```

베지어 곡선 `cubic-bezier(0.0, 0.5, 0.5 ,1.0)`을 사용한 것처럼 기차가 점점 느려지긴 하지만 프로세스 정도가 조금 다른 것을 확인할 수 있습니다.

한편, **베지어 곡선을 사용하면 애니메이션이 지정한 범위를 '넘어서' 적용되게 할 수 있습니다.**

베지어 곡선에서 중간 조절점의 `y` 좌표는 제약이 없습니다. 음수 또는 매우 큰 값도 가능하죠. 그런데 조절점의 `y` 좌표가 음수 또는 큰 값일 때 베지어 곡선은 매우 낮거나 높게 그려집니다. 이러면 애니메이션이 정상 범위를 벗어납니다.

아래쪽 기차 예시에 다음과 같은 css를 적용했다고 가정해봅시다.
```css
.train {
  left: 100px;
  transition: left 5s cubic-bezier(.5, -1, .5, 2);
    /* left 속성값(400px)은 자바스크립트에서 설정함 */
}
```

이 css가 적용되면, `left` 프로퍼티가 `100px`에서 `400px`로 점차 변해야 합니다.

그런데 기차를 클릭하면 기차는 다음과 같이 움직입니다.
- 먼저 기차가 뒤로 이동합니다. `left` 값은 `100px`보다 조금 안되게 설정됩니다.
- 그리고 나서 다시 기차는 앞으로 이동합니다. 이때 `left` 값은 `400px`보다 조금 큽니다.
- 그리고 나서 `left`가 `400px`일 때의 위치로 후진합니다.

##### 결과

![transition-timing-function-3-before](../../images/03/05/02/transition-timing-function-3-before.png)

![transition-timing-function-3-during-1](../../images/03/05/02/transition-timing-function-3-during-1.png)

![transition-timing-function-3-during-2](../../images/03/05/02/transition-timing-function-3-during-2.png)

![transition-timing-function-3-after](../../images/03/05/02/transition-timing-function-3-after.png)

```html
<!-- index.html -->
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <img class="train" src="https://js.cx/clipart/train.gif" onclick="this.style.left='400px'">

</body>

</html>
```
```css
/* style.css */
.train {
  position: relative;
  cursor: pointer;
  width: 177px;
  height: 160px;
  left: 100px;
  transition: left 5s cubic-bezier(.5, -1, .5, 2);
}
```

왜 이렇게 이동하는지는 아래의 베지어 곡선 그래프를 보면 아주 명확히 알 수 있습니다.

![bezier-train-over](../../images/03/05/02/bezier-train-over.svg)

두 번째 조절점의 `y` 좌표가 `0`보다 작아지고, 세 번째 조절점의 좌표가 `1`보다 커지면서 곡선이 '정상' 범위를 벗어난 것을 확인할 수 있습니다. '정상' 범위인 `0..1`을 벗어난 것이죠.

아시다시피, timing 함수의 `y`축은 '애니메이션 프로세스의 완성도'를 나타냅니다. `y`가 `0`일 땐 프로퍼티 시작 값을, `y`가 `1`일 땐 프로세스 종료 값을 의미하죠. 그렇기 때문에 `y`가 `0`보다 작아지면 `left` 프로퍼티가 시작 값인 `100px` 보다 낮게 설정되고, `y`가 `1`보다 커지면 `left` 프로퍼티가 끝값인 `400px`보다 커지게 됩니다.

이 예시에선 `y` 값이 정상 범위를 크게 벗어나지 않기 때문에 '부드럽게' 변형이 일어납니다. 그런데 `y` 값이 `-99`나 `99`가 되면 기차가 앞·뒤로 아주 크게 움직이겠죠?

이쯤 되면 원하는 애니메이션 효과를 줄 수 있는 베지어 곡선은 어떻게 만들 수 있을지 의문이 들 겁니다. 베지어 곡선을 만들어주는 툴은 다양한데, http://cubic-bezier.com/ 에서도 가능합니다.
