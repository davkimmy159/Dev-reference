유니코드: `u` <sub>(플래그)</sub> · `\p{…}` <sub>(클래스)</sub>
===================================

##### JS 문자열
- [유니코드 인코딩](https://en.wikipedia.org/wiki/Unicode) 사용

##### 대다수 문자
- 2바이트 인코딩 <sub>(65,536개 글자 표현)</sub>
  - 모든 글자 표현 X <sub>(숫자 부족)</sub>

##### 일부 문자
- 4바이트 인코딩
- ex\)
  - `𝒳` <sub>(수학 x)</sub>
  - `😄` <sub>(웃는 표정)</sub>
  - 일부 상형 문자
  - 기타 등등

##### 일부 문자
- 문자 바이트 수 상이
  - 2 · 4 바이트
- 코드값 길이 상이

|문자|유니코드|바이트 수|
|:---:|---|:---:|
|`a`|`0x0061`|2|
|`≈`|`0x2248`|2|
|`𝒳`|`0x1d4b3`|4|
|`𝒴`|`0x1d4b4`|4|
|`😄`|`0x1f604`|4|

##### 과거 JS
- 단순한 유니코드 인코딩
  - 4바이트 문자 X
- 일부 언어 기능
  - 해당 문자들 적절히 처리 X

##### `length` <sub>(프로퍼티)</sub>
- 4바이트 문자 → 2바이트 문자 2개
  - 잘못된 결과
  - 하나로 묶어서 취급 필요
    - '서로게이트 쌍'
```javascript
alert('😄'.length); // 2
alert('𝒳'.length);  // 2
```

##### 정규 표현식
- '긴 문자' <sub>(4바이트)</sub>
  - 2바이트 문자 2개 취급 <sub>(기본)</sub>
- `u` <sub>(플래그)</sub>
  - 4바이트 문자 적절히 처리
  - 유니코드 프로퍼티 검색 가능

### `\p{…}` <sub>(유니코드 프로퍼티)</sub>

<img src="../../images/commons/icons/triangle-exclamation-solid.svg" /> **Firefox · Edge 미지원**

##### 버그 有
- [Firefox](https://bugzilla.mozilla.org/show_bug.cgi?id=1361876)
- [Edge](https://github.com/chakra-core/ChakraCore/issues/2969)

##### [XRegExp](https://xregexp.com/) <sub>(라이브러리)</sub>
- 정규 표현식 확장 기능 제공
  - 유니코드 프로퍼티 크로스 브라우저 지원
  - 기타 등등

<br />

##### 모든 유니코드 문자 내 다양한 프로퍼티 有
- 다양한 정보 저장
  - 속한 '범주' 설명
  - 기타 등등
- ex\) `Letter` <sub>(프로퍼티)</sub>
  - 어떤 언어의 글자 의미
- ex\) `Number` <sub>(프로퍼티)</sub>
  - 숫자 <sub>(아라비아 · 한자 등)</sub>
- 기타 등등

##### `\p{…}`
- 프로퍼티 통해 문자 검색
  - ex\) `p{Letter}` · `p{L}`
    - 언어 글자 표기
- `u` <sub>(플래그)</sub> 필수
- 대다수 프로퍼티
  - 약자 有
    - ex\) `L` <sub>(`Letter`)</sub>

##### 아래 예시에서는 영문자, 조지아 문자, 한글 3종류의 글자를 검색합니다.
```javascript
let str = "A ბ ㄱ";

alert( str.match(/\p{L}/gu) ); // A,ბ,ㄱ
alert( str.match(/\p{L}/g) );  // null ('u' 플래그가 없어서 일치 결과 없음)
```

#### 주요 문자 범주 · 하위 범주 목록

##### `L` <sub>(문자)</sub>
문자(Letter) L:
소문자(lowercase) Ll
조정(modifier) Lm
단어의 첫 글자를 대문자로(titlecase) Lt
대문자(uppercase) Lu
기타(other) Lo

|||
|---|---|
|`Ll`|소문자|
|`Lm`|조정|
|`Lt`|단어 첫 글자 → 대문자|
|`Lu`|대문자|
|`Lo`|기타|

숫자(Number) N:
10진수(decimal digit) Nd
문자(letter number) Nl
기타(other) No

##### `N` <sub>(숫자)</sub>

|||
|---|---|
|`Nd`|10진수|
|`Nl`|문자|
|`No`|기타|

문장 부호(Punctuation) P:
연결선(connector) Pc
대시(dash) Pd
처음 따옴표(initial quote) Pi
마지막 따옴표(final quote) Pf
열기(open) Ps
닫기(close) Pe
기타(other) Po

##### `P` <sub>(문장 부호)</sub>

|||
|---|---|
|`Pc`|연결선|
|대시`Pd`||
|`Pi`|처음 따옴표|
|`Pf`|마지막 따옴표|
|`Ps`|열기|
|`Pe`|닫기|
|`Po`|기타|

##### 표시(Mark) `M` (강세 등):
  - 간격 결합(spacing combining) `Mc`
  - 묶음(enclosing) `Me`
  - 비공백(non-spacing) `Mn`

##### 기호(Symbol) `S`:
  - 통화(currency) `Sc`
  - 수정(modifier) `Sk`
  - 수학(math) `Sm`
  - 기타(other) `So`

##### 구분 기호(Separator) `Z`:
  - 줄(line) `Zl`
  - 단락(paragraph) `Zp`
  - 공백(space) `Zs`

##### 기타(Other) `C`:
  - 제어(control) `Cc`
  - 형식(format) `Cf`
  - 할당되지 않음(not assigned) `Cn`
  - 사용자 지정(private use) `Co`
  - 서로게이트(surrogate) `Cs`

예를 들어 소문자를 찾아야 한다면 `\p{Ll}`을, 문장 부호를 찾아야 한다면 `\p{P}`를 사용하는 식으로 검색할 수 있습니다.

또한 다음과 같이 파생된 범주도 있습니다.
- `Alphabetic`(`Alpha`)는 `Letters L`와 로마 숫자 `Ⅻ`같이 문자로 된 숫자 `Nl`에 더해서 `Other_Alphabetic`(`OAlpha`)에 속한 문자들을 모두 포함합니다.
-` Hex_digit`은 16진수 숫자인 `0-9`, `a-f`를 포함합니다.
- 이것 말고도 더 있죠.

유니코드는 정말 다양한 프로퍼티를 지원합니다. 모든 걸 나열하려면 공간이 너무 많이 필요하니 참고할 수 있는 문서를 알려드립니다.
- [문자별 프로퍼티 목록](https://unicode.org/cldr/utility/character.jsp)
- [프로퍼티별 문자 목록](https://unicode.org/cldr/utility/list-unicodeset.jsp)
- [프로퍼티별 줄임말](https://www.unicode.org/Public/UCD/latest/ucd/PropertyValueAliases.txt)
- [텍스트 형식으로 정리된 유니코드 문자와 각 문자의 모든 프로퍼티](https://www.unicode.org/Public/UCD/latest/ucd/)

#### 예시: 16진수
실제 사례로 16진수를 찾아봅시다. `xFF` 형식으로 쓰고 `F` 자리에는 16진수의 숫자(0…1이나 A…F)가 들어갑니다.

16진수 숫자는 `\p{Hex_Digit}`로 표기합니다.
```javascript
let regexp = /x\p{Hex_Digit}\p{Hex_Digit}/u;

alert("number: xAF".match(regexp)); // xAF
```

#### 예시: 한자
한자를 검색해봅시다.

`Script`(표기 체계)라는 유니코드 프로퍼티가 있습니다. `Script`는 `Cyrillic`(키릴 문자), `Greek`(그리스 문자), `Arabic`(아라비아 문자), `Han`(한자) 등의 값을 가질 수 있습니다.

[Script 값의 전체 목록](https://en.wikipedia.org/wiki/Script_(Unicode))

특정 표기 체계의 문자를 찾으려면 `Script=<value>`를 사용해야 합니다. 키릴 문자는 `\p{sc=Cyrillic}`, 한자는 `\p{sc=Han}`로 검색하는 식으로 쓸 수 있습니다.
```javascript
let regexp = /\p{sc=Han}/gu; // 한자를 반환

let str = `Hello Привет 你好 123_456`;

alert( str.match(regexp) ); // 你,好
```

#### 예시: 통화
`$`, `€`, `¥` 등 통화 단위를 나타내는 문자는 유니코드 프로퍼티 `\p{Currency_Symbol}`를 가지고 있습니다. 짧게는 `\p{Sc}`로 사용합니다.

`\p{Sc}`를 사용해서 '통화 단위 바로 뒤 숫자' 형태의 가격 표시를 찾아봅시다.
```javascript
let regexp = /\p{Sc}\d/gu;

let str = `Prices: $2, €1, ¥9`;

alert( str.match(regexp) ); // $2,€1,¥9
```
나중에 Quantifiers +, *, ? and {n}에서 자릿수가 여러 개인 수를 찾는 방법을 알아볼 것입니다.

<br />

## 요약
`u` 플래그로 정규 표현식에서 유니코드 관련 기능을 활성화할 수 있습니다.

즉, 다음 두 기능이 사용 가능해집니다.

1. 4바이트 문자를 2바이트 문자 두 개로 처리하지 않고 문자 한 개로 올바르게 처리합니다.
2. `\p{…}`를 이용해 유니코드 프로퍼티를 검색에 사용할 수 있습니다.

유니코드 프로퍼티를 사용하면 특정 언어의 단어, 따옴표나 통화 단위같은 특수 문자 등을 모두 검색할 수 있습니다.
