Proxy와 Reflect
===============

##### `Proxy`
- 특정 객체 감싼 후
  - 객체에 가하는 작업 중간 가로채는 객체
- 가로채진 작업
  - 프로퍼티 읽기 · 쓰기 등
  - `Proxy` 자체 처리
  - 원래 객체 처리 <sub>(그대로 전달)</sub>

### `Proxy`
- 문법
```javascript
let proxy = new Proxy(target, handler);
```
##### `target`
- 감싸게 될 객체
  - 모든 객체 <sub>(함수 포함)</sub> 가능

##### `handler`
- '트랩<sub>(trap)</sub>' 담긴 객체
  - 동작 가로채는 메서드
- 프락시 설정 위치

##### 프락시 설정 예시
- get 트랩
  - `target` 프로퍼티 읽을 때 활성화
- set 트랩
  - `target` 프로퍼티 쓸 때 활성화

##### 순서
1. `proxy` 에 작업 가해짐
2. `handler` 에 작업 상응 트랩
    - 존재 시
      - 트랩 실행
      - 프락시 : 작업 처리 기회 얻음
    - 부재 시
      - `target` 에 작업 직접 수행

##### 트랩 없는 프락시 사용
```javascript
let target = {};
let proxy = new Proxy(target, {}); // 빈 핸들러

// (1)
// 프락시에 값 씀
proxy.test = 5;

// target
// - 새 프로퍼티 생성
alert(target.test); // 5

// (2)
// 프락시 사용해 값 읽음
alert(proxy.test); // 5

// (3)
// 반복 정상 동작
for(let key in proxy) alert(key); // test
```

##### 프락시 : 트랩 X
- `proxy` 에 가해지는 모든 작업
  - `target` 에 전달
1. `proxy.test=` <sub>(값 쓰기)</sub>
    - `target`
      - 새 값 설정
2. `proxy.test` <sub>(값 읽기)</sub>
    - `target` <sub>(에서)</sub>
      - 값 읽어옴
3. `proxy` 대상 반복 작업
    - `target` 저장 값 반환

##### 트랩 부재 시
- `proxy`
  - `target` 둘러싸는 투명한 래퍼

![proxy](../../images/14/01/proxy.svg)

##### `Proxy` == '특수 객체'
- 일반 객체와 다른 행동 양상
  - 프로퍼티 X
- `handler` 비어있음
  - `Proxy`에 가해지는 작업
    - `target` 에 곧바로 전달

#### 트랩 사용해 가로챌 수 있는 작업

##### 객체 어떤 작업 시
- '내부 메서드' <sub>(JS 명세서 정의)</sub>
  - 깊숙한 곳에서 관여

##### 내부 메서드
- 명세서에만 정의
  - 코드 사용해 호출 X
- ex&#41; 프로퍼티 읽기
  - `[[Get]]` <sub>(내부 메서드)</sub> 관여
- ex&#41; 프로퍼티 쓰기
  - `[[Set]]` <sub>(내부 메서드)</sub> 관여

##### 프락시 트랩
- 내부 메서드 호출 가로챔
- 가로채는 내부 메서드 리스트
  - 명세서 명시
- 모든 내부 메서드
  - 대응 트랩 존재

##### `handler` <sub>(`new Proxy` 매개변수)</sub> 추가 가능 메서드명

|내부 메서드|핸들러 메서드|작동 시점|
|---|---|---|
|`[[Get]]`|`get`|프로퍼티 읽기|
|`[[Set]]`|`set`|프로퍼티 쓰기|
|`[[HasProperty]]`|`has`|`in` <sub>(연산자)</sub> 동작|
|`[[Delete]]`|`deleteProperty`|`delete` <sub>(연산자)</sub> 동작|
|`[[Call]]`|`apply`|함수 호출|
|`[[Construct]]`|`construct`|`new` <sub>(연산자)</sub> 동작|
|`[[GetPrototypeOf]]`|`getPrototypeOf`|`Object.getPrototypeOf`|
|`[[SetPrototypeOf]]`|`setPrototypeOf`|`Object.setPrototypeOf`|
|`[[IsExtensible]]`|`isExtensible`|`Object.isExtensible`|
|`[[PreventExtensions]]`|`preventExtensions`|`Object.preventExtensions`|
|`[[DefineOwnProperty]]`|`defineProperty`|`Object.defineProperty`<br />`Object.defineProperties`|
|`[[GetOwnProperty]]`|`getOwnPropertyDescriptor`|`Object.getOwnPropertyDescriptor`<br />`for…in` <sub>(반복문)</sub><br />`Object.keys`<br />`Object.values`<br />`Object.entries`|
|`[[OwnPropertyKeys]]`|`ownKeys`|`Object.getOwnPropertyNames`<br />`Object.getOwnPropertySymbols`<br />`for…in` <sub>(반복문)</sub><br />`Object.keys`<br />`Object.values`<br />`Object.entries`|

