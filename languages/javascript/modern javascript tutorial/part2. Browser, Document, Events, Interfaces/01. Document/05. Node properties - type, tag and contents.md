주요 노드 프로퍼티
=================

### DOM 노드 클래스

##### DOM 노드
- 종류 따라 각각 다른 프로퍼티 지원
- ex&#41;
  - `<a>` <sub>(태그)</sub> 대응 요소 노드
    - 링크 관련 프로퍼티
  - `<input>` <sub>(태그)</sub> 대응 요소 노드
    - 입력 관련 프로퍼티
  - 텍스트 노드
    - 요소 노드 · 다른 프로퍼티 지원

##### 모든 DOM 노드
- 공통 조상
  - 공통 프로퍼티 · 메서드 지원

##### 대응 내장 클래스
- DOM 노드 종류 따라 상이
- 계층 구조

![dom-class-hierarchy](../../images/02/01/05/dom-class-hierarchy.svg)

#### 대응 클래스

##### `EventTarget`
- '추상' 클래스 <sub>(루트)</sub>
  - 대응 객체 생성 X
- DOM 노드 베이스
  - 모든 DOM 노드
    - '이벤트' 사용 가능

##### `Node`
- '추상' 클래스
  - 대응 객체 생성 X
- DOM 노드 베이스
  - `Text` <sub>(텍스트 노드 클래스)</sub>
  - `Element` <sub>(요소 노드 클래스)</sub>
  - `Comment` <sub>(주석 노드 클래스)</sub>
- 주요 트리 탐색 기능
  - `parentNode`
  - `nextSibling`
  - `childNodes`
  - 기타 등등

##### `Element`
- DOM 요소 노드 베이스
  - `HTMLElement` <sub>(HTML 요소 노드 클래스)</sub>
  - `XMLElement` <sub>(XML 노드 클래스)</sub>
  - `SVGElement` <sub>(SVG 노드 클래스)</sub>
- 요소 전용 탐색 기능 <sub>(프로퍼티· 메서드)</sub>
  - `nextElementSibling`
  - `children`
  - `getElementsByTagName`
  - `querySelector`
  - 기타 등등

##### `HTMLElement`
- HTML 요소 노드 베이스 
  - `HTMLInputElement`
    - `<input>` <sub>(요소)</sub> 클래스
  - `HTMLBodyElement`
    - `<body>` <sub>(요소)</sub> 클래스
  - `HTMLAnchorElement`
    - `<a>` <sub>(요소)</sub> 클래스

##### 이외 다양한 클래스 존재
- 태그 대응 클래스
  - 고유 프로퍼티 · 메서드 지원

#### 특정 노드 사용 가능 프로퍼티 · 메서드
- 상속 기반 결정

##### ex&#41; `<input>` <sub>(`HTMLInputElement` 클래스 기반 요소)</sub> 
- `HTMLInputElement`
  - 입력 관련 프로퍼티
- `HTMLElement`
  - HTML 요소 메서드
  - getter
  - setter
- `Element`
  - 요소 노드 메서드
- `Node`
  - 공통 DOM 노드 프로퍼티
- `EventTarget`
  - 이벤트 관련 기능
- `Object`
  - '일반 객체' 메서드
    - ex&#41; `hasOwnProperty`

##### DOM 노드 클래스 이름
- `constructor.name` <sub>(프로퍼티)</sub>
```javascript
alert( document.body.constructor.name );// "HTMLBodyElement"
```
- `toString` <sub>(메서드)</sub>
```javascript
alert( document.body ); // "[object HTMLBodyElement]"
```

##### `instanceof` <sub>(연산자)</sub>
```javascript
alert( document.body instanceof HTMLBodyElement ); // true
alert( document.body instanceof HTMLElement );     // true
alert( document.body instanceof Element );         // true
alert( document.body instanceof Node );            // true
alert( document.body instanceof EventTarget );     // true
```

##### DOM 노드
- 일반 JS 객체
  - 프로토타입 기반 상속
- `console.dir` <sub>(브라우저 콘솔)</sub>
  - 프로토타입 상속 관계 확인

<br />

<img class="icon" src="../../images/commons/icons/circle-exclamation-solid.svg" /> **`console.log` vs `console.dir`**

##### JS 객체 <sub>(인수)</sub>
- 대개 동일 결과

##### DOM 요소 <sub>(인수)</sub>
- `console.log`
  - 요소 DOM 트리 출력
- `console.dir`
  - 요소 : DOM 객체 취급 출력
    - 프로퍼티 확인 용이

<br />

<img class="icon" src="../../images/commons/icons/circle-exclamation-solid.svg" /> **IDL <sub>(명세서 코드 설면 언어)</sub>**

##### Interface Description Language
- 명세서 클래스 설명 언어
- 타입
  - 프로퍼티 앞

##### ex&#41; `HTMLInputElement` <sub>(`<input>` 요소 클래스)</sub>
```typescript
// HTMLInputElement (클래스) 정의 시
// - HTMLInputElement (클래스) → HTMLElement (클래스) 상속
interface HTMLInputElement: HTMLElement {
  // <input> (요소) 관련 프로퍼티 · 메서드 나열 시작

  // DOMString (문자열 타입)
  attribute DOMString accept;
  attribute DOMString alt;
  attribute DOMString autocomplete;
  attribute DOMString value;

  // 불린형
  attribute boolean autofocus;
  … 
  
  // void (메서드 리턴값 X)
  void select();
  …
}
```
<br />

### `nodeType` <sub>(구식 프로퍼티)</sub>
- DOM 노드 타입 <sub>(상숫값)</sub>
  - 읽기 전용 <sub>(값 수정 X)</sub>
- 주요 노드 타입 <sub>(기타 노드 : 명세서 참조)</sub>

|상숫값|노드 타입|
|:---:|---|
|1|요소 노드|
|3|텍스트 노드|
|9|문서 객체|

```html
<body>
  <script>
  let elem = document.body;

  alert( elem.nodeType );            // 1 (요소 노드)
  alert( elem.firstChild.nodeType ); // 3 (텍스트 노드)
  alert( document.nodeType );        // 9 (문서 객체)
  </script>
</body>
```

##### 모던 JS 노드 타입 확인
- 평소
  - `instanceof` <sub>(연산자)</sub>
  - 클래스
- 가끔
  - `nodeType`

### 태그 이름 확인 <sub>(`nodeName` · `tagName` 프로퍼티)</sub>
```javascript
alert( document.body.nodeName ); // BODY
alert( document.body.tagName );  // BODY
```

#### 차이

##### `nodeName` <sub>(프로퍼티)</sub>
- 모든 노드
  - 요소 노드
    - `tagName` 동일
  - 이외 노드 <sub>(텍스트 · 주석 등)</sub>
    - 노드 타입 문자

##### `tagName` <sub>(프로퍼티)</sub>
- 요소 노드
```html
<body>
  <!-- 주석 -->
  <script>
    // 주석 노드
    alert( document.body.firstChild.nodeName ); // #comment
    alert( document.body.firstChild.tagName );  // undefined (요소 X)

    // 문서 노드
    alert( document.nodeName ); // #document
    alert( document.tagName );  // undefined (요소 X)
  </script>
</body>
```

##### 요소 노드
- 차이 X

<br />

<img class="icon" src="../../images/commons/icons/circle-exclamation-solid.svg" /> **태그명 : 항상 대문자 <sub>(XML 모드 제외)</sub>**

#### 브라우저 모드

##### HTML 모드
- 웹페이지
- `nodeName` · `tagName` <sub>(프로퍼티)</sub>
  - 대문자 변환
##### XML 모드
- XML 문서
  - `Content-Type: application/xml+xhtml` <sub>(헤더)</sub>
- 대 · 소문자 유지
- 최근 거의 사용 X

<br />

### 내용 조작 <sub>(`innerHTML` 프로퍼티)</sub>
- 요소 내 HTML 반환 · 수정
  - 문자열 형태

##### `document.body` <sub>(요소)</sub> 내용 · 출력 · 수정
```html
<body>
  <p>p 태그</p>
  <div>div 태그</div>

  <script>
    alert( document.body.innerHTML );        // 내용 읽기
    document.body.innerHTML = '새로운 BODY!'; // 내용 교체
  </script>

</body>
```

##### 문법 틀린 HTML
- 자동 교정 <sub>(브라우저)</sub>
```html
<body>

  <script>
    document.body.innerHTML = '<b>test'; // 닫는 태그 X
    alert( document.body.innerHTML );    // <b>test</b> (자동 수정)
  </script>

</body>
```

<br />

<img class="icon" src="../../images/commons/icons/circle-exclamation-solid.svg" /> **스크립트 실행 X**

##### `<script>` <sub>(태그)</sub> 삽입 시
- HTML 일부 구성
- 실행 X

<br />

### `innerHTML+=` 주의점
##### 요소에 HTML 추가
- 단순 추가 X
- 덮어쓰기
  1. 기존 내용 삭제
  2. 새 내용 삽입
      - 기존 내용 + 추가 내용
```javascript
// 기술적으로 동일 작업
elem.innerHTML += "…";
elem.innerHTML = elem.innerHTML + "…"
```

##### 리소스 <sub>(이미지 등)</sub> 전부 다시 로딩
1. 기존 내용 '완전히 삭제'
2. 밑바닥부터 다시 내용 씀
```javascript
chatDiv.innerHTML += "<div>안녕하세요<img src='smile.gif'/> !</div>";

// 윗줄 HTML 내용 재생성
// - smile.gif (리소스) 재로딩
chatDiv.innerHTML += "잘 지내죠?";
```

##### 이 외 여러 부작용
- 텍스트 마우스 드래그 해제
- `<input>` <sub>(태그)</sub> 사용자 입력 값 사라짐
- 기타 등등

### 요소 전체 HTML <sub>(`outerHTML`)</sub>
`innerHTML` + 요소 자체
```html
<div id="elem">Hello <b>World</b></div>

<script>
  alert(elem.outerHTML); // <div id="elem">Hello <b>World</b></div>
</script>
```

##### HTML 쓰기
- 요소 자체 바뀌지 않음
- DOM 안 요소 교체
```html
<div>Hello, world!</div>

<script>
  let div = document.querySelector('div');

  // <p>…</p> 교체
  div.outerHTML = '<p>새로운 요소</p>';

  // 기존 내용 그대로 유지
  alert(div.outerHTML); // <div>Hello, world!</div>
</script>
```

##### 이유
- 기존 DOM 요소
  - 수정 X
  - 문서에서 제거
    - 변수에 여전히 저장
- 새 DOM 요소
  - 어디에도 저장 X

##### `div.outerHTML= …`
1. 문서에서 요소 삭제
2. 새 HTML 조각 <sub>(`<p>새로운 요소</p>`)</sub>
    - 삭제 후 생긴 공간에 삽입
    - 어디에도 저장 X
3. 기존 요소
    - `div` <sub>(변수)</sub> 에 여전히 저장

##### `outerHTML` 동작 방식
- 실수 발생 여지 ↑
- `div.outerHTML` 수정 후
  - div <sub>(변수)</sub> 새 할당 착각

##### 정리
- `innerHTML`
  - 변수 수정
- `outerHTML`
  - 변수 수정 X

### 텍스트 노드 내용 조작 <sub>(`nodeValue` · `data`)</sub>

##### `innerHTML` <sub>(프로퍼티)</sub>
- 요소 노드에만 사용

##### 다른 타입 노드
- `nodeValue` <sub>(프로퍼티)</sub>
- `data` <sub>(프로퍼티)</sub>

##### 두 프로퍼티
- 아주 유사
- 실무 : 구분 없이 사용
- 작은 차이 <sub>(명세서)</sub>
  - 영향 X

##### 텍스트 · 주석 노드 내용 읽기
```html
<body>
  안녕하세요.
  <!-- 주석 -->
  <script>
    let text = document.body.firstChild;
    alert(text.data);   // 안녕하세요.

    let comment = text.nextSibling;
    alert(comment.data); // 주석
  </script>
</body>
```

##### 주석 노드 기능 구현 이유
- 종종 주석 사용해 정보 · 지시사항 삽입
- 주석 노드 내용 읽고 삽입된 지시사항 처리
  - `data` <sub>(프로퍼티)</sub>
```html
<!-- if isAdmin -->
  <div>관리자로 로그인하였습니다!</div>
<!-- /if -->
```

### 순수한 텍스트 <sub>(`textContent`)</sub>
- 요소 내 텍스트만 반환
  - 태그 제외
```html
<div id="news">
  <h1>주요 뉴스!</h1>
  <p>화성인이 지구를 침공하였습니다!</p>
</div>

<script>
  // 주요 뉴스! 화성인이 지구를 침공하였습니다!
  alert(news.textContent);
</script>
```

#### '안전한 방법'으로 텍스트 쓰기

##### 사용자 입력 문자열
- `innerHTML`
  - 태그 함께 저장 <sub>(HTML 형태)</sub>
- `textContent`
  - 특수문자 <sub>(태그 포함)</sub> : 문자열 처리
```html
<div id="elem1"></div>
<div id="elem2"></div>

<script>
  let name = prompt("이름을 알려주세요.", "<b>이보라</b>");

  // HTML 형태 저장
  // 굵은 글씨 출력 (태그 해석)
  elem1.innerHTML = name;

  // 텍스트 형태 저장
  // <b>이보라</b> 출력 (입력 값 그대로)
  elem2.textContent = name;
</script>
```

##### 사용자 입력값 받아 처리 시
- 텍스트 처리 필수
  - 예상치 못한 HTML 침투 방지

### `hidden` <sub>(프로퍼티)</sub>

##### `hidden` <sub>(속성 · 프로퍼티)</sub>
- 요소 출력 여부 지정
- `style="display:none"`
  - 기술적으로 동일
```html
<div>아래 두 div를 숨겨봅시다.</div>

<div hidden>HTML의 hidden 속성 사용하기</div>

<div id="elem">자바스크립트의 hidden 프로퍼티 사용하기</div>

<script>
  elem.hidden = true;
</script>
```

##### 요소 깜빡이기
```html
<div id="elem">깜빡이는 요소</div>

<script>
  setInterval(() => elem.hidden = !elem.hidden, 1000);
</script>
```

### 기타 프로퍼티

##### `value` <sub>(값 저장)</sub>
- `<input>` <sub>(`HTMLInputElement`)</sub>
- `<select>` <sub>(`HTMLSelectElement`)</sub>
- `<textarea>` <sub>(HTMLTextareaElement)</sub>

##### `href` <sub>(`href` 속성 값 저장)</sub>
- `<a>` <sub>(`HTMLAnchorElement`)</sub>

##### `id` <sub>(`id` 속성 값 저장</sub>
- 모든 요소 노드 <sub>(`HTMLElement`)</sub>

##### 기타 등등
- 이외 다양한 프로퍼티 존재
```html
<input type="text" id="elem" value="value">

<script>
  alert(elem.type);  // "text"
  alert(elem.id);    // "elem"
  alert(elem.value); // value
</script>
```

##### 대다수 표준 HTML 속성
- 대응 DOM 프로퍼티 존재

##### 각 클래스 지원 프로퍼티 목록
- 명세서 참조
  - ex&#41; [`HTMLInputElement`](https://html.spec.whatwg.org/#htmlinputelement) <sub>(`<input>`)</sub>
- 개발자 도구
  - `console.dir` 입력 <sub>(콘솔 창)</sub>
  - `Properties`<sub>(`Elements` 패널 하위 패널)</sub>

<br />

## 요약

##### 각 DOM 노드
- 고유 클래스에 속함
  - 계층 구조 형성
  - 지원 프로퍼티 · 메서드 결정

#### 주요 DOM 노드 프로퍼티

##### `nodeType` <sub>(구식)</sub>
- 요소 타입
  - 요소 대응 상숫값
- 일기 전용

##### `nodeName` · `tagName`
- 일반 노드 · 요소 태그 이름
- 항상 대문자 변환
  - XML 모드 제외
- 읽기 전용

##### `innerHTML`
- 요소 내 HTML 얻기 · 수정

##### `outerHTML`
- 요소 전체 HTML 얻기 · 수정
- 수정 시
  - 변수 갱신 X
  - 문서만 갱신

##### `nodeValue` · `data`
- 非요소 노드 내용 읽기 · 수정
  - 텍스트 노드
  - 주석 노드
  - 기타 등등
- 두 프로퍼티
  - 거의 동일 동작
  - `data` 주로 사용

##### `textContent`
- 순수 텍스트 <sub>(태그 제외)</sub> 읽기 · 쓰기
- 특수문자 <sub>(태그 포함)<sub>
  - 문자열 처리
- 사용자 입력
  - 안전안 방법으로 처리
- 원치 않는 HTML 삽입 예방

`hidden`
true로 설정하면 CSS에서 display:none을 설정한 것과 동일하게 동작합니다.

DOM 노드는 클래스에 따라 이 외에도 다른 프로퍼티를 가집니다. `<input>` 요소(HTMLInputElement)는 value, type 프로퍼티를, `<a>` 요소(HTMLAnchorElement)는 href 프로퍼티를 지원하는 것 같이 말이죠. 대부분의 표준 HTML 속성은 대응하는 DOM 프로퍼티를 가집니다.

그런데 HTML 요소와 DOM 프로퍼티가 항상 같은 것은 아닙니다. 관련 내용은 다음 챕터에서 살펴보도록 하겠습니다.

<br />

### <img class="icon" src="../../images/commons/icons/circle-check-solid.svg" /> 과제

<hr />

### 후손 노드 개수 세기
ul과 li 노드로 구성된 트리 구조 문서가 있다고 가정해 봅시다.

li 노드 전체를 대상으로 아래와 같은 작업을 하려 합니다. 조건을 만족시킬 수 있는 코드를 작성해 보세요.

1. li 노드 안에 있는 텍스트를 출력
2. li 노드 아래에 있는 모든 <li> 태그의 개수를 출력

<br />

<img class="icon" src="../../images/commons/icons/circle-answer.svg" />

`<li>`를 이용한 반복문을 만들어 봅시다.
```javascript
for (let li of document.querySelectorAll('li')) {
  …
}
```

반복문 안에서 각각의 li 안에 있는 텍스트를 가져와야 합니다.

li의 첫 번째 자식 노드인 텍스트 노드로부터 텍스트를 읽을 수 있습니다.
```javascript
for (let li of document.querySelectorAll('li')) {
  let title = li.firstChild.data;

  // title은 <li> 안에 있는 다른 노드들보다 앞에 위치한 텍스트입니다.
}
```

그리고 li.getElementsByTagName('li').length를 이용해 li 노드 아래에 있는 모든 `<li>` 태그의 개수를 가져올 수 있습니다.

<hr />

### 노드 타입 맞추기
스크립트를 실행 결과를 예측해보세요.
```html
<html>

<body>
  <script>
    alert(document.body.lastChild.nodeType);
  </script>
</body>

</html>
```

<br />

<img class="icon" src="../../images/commons/icons/circle-answer.svg" />

함정이 있는 문제였습니다.

`<script>`가 실행되는 시점엔 브라우저가 `<script>` 아래에 있는 문서를 처리하지 못했기 때문에 가장 마지막 DOM 노드는 `<script>` 자기 자신입니다.

따라서 얼럿창엔 1(요소 노드)이 출력됩니다.
```html
<html>

<body>
  <script>
    alert(document.body.lastChild.nodeType);
  </script>
</body>

</html>
```

<hr />

### 주석 안의 태그
스크립트를 실행 결과를 예측해보세요.
```html
<script>
  let body = document.body;

  body.innerHTML = "<!--" + body.tagName + "-->";

  alert( body.firstChild.data ); // 얼럿 창엔 어떤 내용이 출력될까요?
</script>
```

<br />

<img class="icon" src="../../images/commons/icons/circle-answer.svg" />

**BODY**가 출력됩니다.
```html
<script>
  let body = document.body;

  body.innerHTML = "<!--" + body.tagName + "-->";

  alert( body.firstChild.data ); // BODY
</script>
```

차근차근 설명해보겠습니다.

1. `<body>`의 콘텐츠가 `<!--BODY-->`로 대체됩니다. body.tagName은 "BODY"이기 때문입니다. tagName은 항상 대문자라는 점을 잊지 마세요.
2. `<body>`의 콘텐츠가 교체되면서 주석이 유일한 자식 노드가 됩니다. 따라서 body.firstChild을 사용해 주석을 얻을 수 있게 됩니다.
3. 주석 노드의 data 프로퍼티엔 주석 내용(`<!-- … -->` 안쪽의 내용)이 저장됩니다. 따라서 data 프로퍼티의 값은 "BODY"입니다.

<hr />

### DOM 계층 구조와 'document'
document는 어떤 클래스에 속할까요?

DOM 계층 구조에서 document이 속한 클래스는 어디에 위치해 있을까요?

이 클래스는 Node, Element, HTMLElement 중 어떤 클래스를 상속받을까요?

<br />

<img class="icon" src="../../images/commons/icons/circle-answer.svg" />

document 노드가 어떤 클래스에 속해있는지는 아래와 같은 스크립트를 통해 확인할 수 있습니다.
```javascript
alert(document); // [object HTMLDocument]
```

아래 스크립트로도 확인할 수 있습니다.
```javascript
alert(document.constructor.name); // HTMLDocument
```

살펴본 바와 같이 document는 HTMLDocument 클래스의 인스턴스입니다.

그렇다면 HTMLDocument 클래스는 DOM 계층 구조에서 어디에 있을까요?

명세서를 확인하면 알 수 있긴 하지만, 직접 만든 코드를 사용하면 위치를 더 빨리 알아낼 수 있습니다.

__proto__를 사용해 프로토타입 체인을 거슬러 올라가 봅시다.

아시다시피 클래스의 메서드는 생성자의 prototype에 구현되어있습니다. document의 메서드는 HTMLDocument.prototype에 구현되어 있죠.

여기에 더하여 prototype 안에는 생성자 함수의 참조 역시 저장되어 있습니다. 이를 확인해 봅시다.
```javascript
alert(HTMLDocument.prototype.constructor === HTMLDocument); // true
```

클래스 이름을 얻으려면 constructor.name를 사용하면 됩니다. Node 클래스를 만날 때까지 document의 프로토타입 체인 전체를 거슬러 올라가 보겠습니다.
```javascript
alert(HTMLDocument.prototype.constructor.name); // HTMLDocument
alert(HTMLDocument.prototype.__proto__.constructor.name); // Document
alert(HTMLDocument.prototype.__proto__.__proto__.constructor.name); // Node
```

위와 같은 코드를 사용해 계층 구조를 파악할 수 있습니다.

이 외에도 개발자 도구에서 console.dir(document)를 사용해 객체를 검사하고, __proto__에 저장된 정보를 통해 이름을 알아낼 수도 있습니다. 브라우저 콘솔 내부에서 자동으로 constructor의 이름을 추출하기 때문입니다.
