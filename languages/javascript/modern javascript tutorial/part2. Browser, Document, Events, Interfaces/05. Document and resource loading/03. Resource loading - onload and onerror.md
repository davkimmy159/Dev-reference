`on[loadÂ·error]` <sub>(ë¦¬ì†ŒìŠ¤ ë¡œë”©)</sub>
====

##### ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ë¡œë”© ì¶”ì  ê°€ëŠ¥ <sub>(ë¸Œë¼ìš°ì €)</sub>
- ìŠ¤í¬ë¦½íŠ¸
- `iframe` <sub>(ìš”ì†Œ)</sub>
- ì´ë¯¸ì§€
- ê¸°íƒ€ ë“±ë“±

##### ë¦¬ì†ŒìŠ¤ ë¡œë“œ ê´€ë ¨ ì´ë²¤íŠ¸
- `load`
  - ì„±ê³µ ì‹œ ë°œìƒ
- `error`
  - ì‹¤íŒ¨ ì‹œ ë°œìƒ

### ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ

##### ì„œë“œíŒŒí‹° ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
- ìŠ¤í¬ë¦½íŠ¸ ë‚´ í•¨ìˆ˜
  - ë¡œë“œ ì™„ë£Œ ì‹œ í˜¸ì¶œ ê°€ëŠ¥
```javascript
let script = document.createElement('script');
script.src = "my.js";

document.head.append(script);
```

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **ì£¼ì˜**

##### JS ëª¨ë“ˆ
- ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¯¸ì§€ì› ê°€ëŠ¥ì„± æœ‰

<br />

#### `load` <sub>(ì´ë²¤íŠ¸)</sub>

##### `<script>` <sub>(ìš”ì†Œ)</sub> ë°œìƒ
- `onload` <sub>(í”„ë¡œí¼í‹°)</sub>

##### ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ Â· ì‹¤í–‰ í›„ ë°œìƒ
```javascript
let script = document.createElement('script');
script.src = "https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js";

document.head.append(script);

// í•¸ë“¤ëŸ¬ ì„¤ì •
// - ìŠ¤í¬ë¦½íŠ¸ ë‚´ ë³€ìˆ˜ Â· í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥
script.onload = function() {

  // lodash (ë¼ì´ë¸ŒëŸ¬ë¦¬) ìŠ¤í¬ë¦½íŠ¸
  // - `_` (ë³€ìˆ˜) ìƒì„±
  alert( _.VERSION ); // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „
};
```

#### `error` <sub>(ì´ë²¤íŠ¸)</sub>

##### `<script>` <sub>(ìš”ì†Œ)</sub> ë°œìƒ
- `onerror` <sub>(í”„ë¡œí¼í‹°)</sub>

##### ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ë°œìƒ
- `404` ì—ëŸ¬ <sub>(ìŠ¤í¬ë¦½íŠ¸ ë¶€ì¬)</sub>
- ì„œë²„ ë¬¸ì œ ë°œìƒ <sub>(ì‚¬ìš© ë¶ˆê°€ëŠ¥)</sub>
- ê¸°íƒ€ ë“±ë“±

##### HTTP ì—ëŸ¬ ìƒì„¸ ì •ë³´ ë¯¸í¬í•¨
- ë¡œë“œ ì‹¤íŒ¨ ì—¬ë¶€ë§Œ í™•ì¸

##### `404` ì—ëŸ¬ <sub>(ë¶€ì¬ ìŠ¤í¬ë¦½íŠ¸ ìš”ì²­)</sub>
```javascript
let script = document.createElement('script');

// ë¶€ì¬ ìŠ¤í¬ë¦½íŠ¸
script.src = "https://example.com/404.js";

document.head.append(script);

// í•¸ë“¤ëŸ¬ ì„¤ì •
script.onerror = function() {

  // Error loading https://example.com/404.js
  alert("Error loading " + this.src);
};
```

<br />

<img src="../../images/commons/icons/triangle-exclamation-solid.svg" /> **ì¤‘ìš”**

##### `load` Â· `error` <sub>(ì´ë²¤íŠ¸)</sub>
- ë¡œë“œ ì™¸ ì¶”ì  X
  - ì˜¤ë¥˜
  - ì‹¤í–‰
  - ê¸°íƒ€ ë“±ë“±

##### `load` <sub>(ì´ë²¤íŠ¸)</sub>
- ë¡œë“œ ì™„ë£Œ ì‹œ ë°œìƒ
  - ìŠ¤í¬ë¦½íŠ¸ ë‚´ ì—ëŸ¬ ì—¬ë¶€ ë¬´ê´€
- `window.onerror` <sub>(ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬)</sub>
  - ìŠ¤í¬ë¦½íŠ¸ ë‚´ ì—ëŸ¬ ì¶”ì  ê°€ëŠ¥

<br />

### ê¸°íƒ€ ë¦¬ì†ŒìŠ¤

##### `load` Â· `error` <sub>(ì´ë²¤íŠ¸)</sub>
- ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ <sub>(`src` ì†ì„±)</sub> ìš”ì†Œ ë°œìƒ
```javascript
let img = document.createElement('img');

// ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ì„¤ì • (src ì†ì„±)
img.src = "https://js.cx/clipart/train.gif";

img.onload = function() {
  alert(`Image loaded, size ${img.width}x${img.height}`);
};

img.onerror = function() {
  alert("Error occurred while loading image");
};
```

#### íŠ¹ì§• <sub>(ì—­ì‚¬ì  ì´ìœ )</sub>

##### ëŒ€ë‹¤ìˆ˜ ë¦¬ì†ŒìŠ¤ <sub>(ìš”ì†Œ)</sub>
- ë¬¸ì„œ ë‚´ ì¶”ê°€ ì‹œ ë¡œë“œ ì‹œì‘

##### `<img>` <sub>(ìš”ì†Œ)</sub>
- `src` <sub>(ì†ì„±)</sub> ì„¤ì • ì‹œ ë¡œë“œ ì‹œì‘

##### `<iframe>` <sub>(ìš”ì†Œ)</sub>
- `load` <sub>(ì´ë²¤íŠ¸)</sub>
  - ë¡œë“œ ì¢…ë£Œ ì‹œ ë°œìƒ <sub>(ì„±ê³µ Â· ì‹¤íŒ¨ ì—¬ë¶€ ë¬´ê´€)</sub>
- `error` <sub>(ì´ë²¤íŠ¸)</sub> ë¯¸ë°œìƒ

### í¬ë¡œìŠ¤ ì˜¤ë¦¬ì§„ ì •ì±…

#### ì˜¤ë¦¬ì§„ <sub>(ë„ë©”ì¸ Â· í¬íŠ¸ Â· í”„ë¡œí† ì½œ)</sub> ê·œì¹™

##### ìƒì´ ì˜¤ë¦¬ì§„ ë‚´ìš© ì ‘ê·¼ ë¶ˆê°€ëŠ¥
- ex\) `https://another.com` <sub>(ë‚´ë¶€ ìŠ¤í¬ë¦½íŠ¸)</sub>
  - `https://mail.com` ë©”ì¼ ì ‘ê·¼ ë¶ˆê°€ëŠ¥

##### ìƒì´ ì˜¤ë¦¬ì§„ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ë¶ˆê°€ëŠ¥
- ìƒì´ ì˜¤ë¦¬ì§„ ìŠ¤í¬ë¦½íŠ¸ <sub>(ì—ëŸ¬ ìœ ë°œ)</sub> ì‚¬ìš© ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ ì ‘ê·¼ ë¶ˆê°€ëŠ¥

##### `error.js` <sub>(ìŠ¤í¬ë¦½íŠ¸)</sub>
- ì˜ëª»ëœ í•¨ìˆ˜ í˜¸ì¶œ êµ¬í˜„ <sub>(ì—ëŸ¬ ìœ ë°œ)</sub>
```javascript
/* ğŸ“„ error.js */
noSuchFunction();
```
- ë™ì¼ ì‚¬ì´íŠ¸ ë‚´ í•¨ìˆ˜ <sub>(`error.js`)</sub> í˜¸ì¶œ ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ í‘œì‹œ
```html
<script>
  window.onerror = function(message, url, line, col, errorObj) {
    alert(`${message}\n${url}, ${line}:${col}`);
  };
</script>

<script src="/article/onload-onerror/crossorigin/error.js"></script>
```
```
Uncaught ReferenceError: noSuchFunction is not defined
https://javascript.info/article/onload-onerror/crossorigin/error.js, 1:1
```
- íƒ€ ë„ë©”ì¸ ë‚´ í•¨ìˆ˜ <sub>(`error.js`)</sub> í˜¸ì¶œ ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ ç„¡ <sub>(ë¸Œë¼ìš°ì €ë³„ ë‚´ìš© ìƒì´)</sub>
```html
<script>
  window.onerror = function(message, url, line, col, errorObj) {
    alert(`${message}\n${url}, ${line}:${col}`);
  };
</script>

<script src="https://cors.javascript.info/article/onload-onerror/crossorigin/error.js"></script>
```
```
Script error.
, 0:0
```

##### ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬ <sub>(`window.onerror`)</sub>
- ì—ëŸ¬ ë°œìƒ ì‹œ ì €ì¥
- ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ <sub>(ì—ëŸ¬ ì ‘ê·¼ Â· ë¶„ì„)</sub>
  - ì‹¤ì œ ì‚¬ìš©ì ìœ ë°œ ì—ëŸ¬ ì²˜ë¦¬
- ìƒì´ ì˜¤ë¦¬ì§„ ìŠ¤í¬ë¦½íŠ¸
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ ç„¡

##### ê¸°íƒ€ ë¦¬ì†ŒìŠ¤
- ë™ì¼ ê·œì¹™ ì ìš© <sub>(ìƒì„¸ ì •ë³´ ç„¡)</sub>

#### í¬ë¡œìŠ¤ ì˜¤ë¦¬ì§„ ì ‘ê·¼ í—ˆìš© ë°©ë²•
- `<script>` <sub>(íƒœê·¸)</sub>
  - `crossorigin` <sub>(ì†ì„±)</sub> ì„¤ì •
- ì›ê²© ì„œë²„
  - íŠ¹ìˆ˜ í—¤ë” ì œê³µ

#### `crossorigin` <sub>(ì†ì„±)</sub> ì„¤ì • <sub>(3ê°€ì§€)</sub>

##### 1. ì†ì„± ç„¡
- ì ‘ê·¼ ê±°ì ˆ

##### 2. `"anonymous"`
- ì›ê²© ì„œë²„ í—¤ë” ì‘ë‹µ ì‹œ ì ‘ê·¼ í—ˆìš©
- ì¸ì¦ ì •ë³´ Â· ì¿ í‚¤ ì„œë²„ ë¯¸ì „ì†¡ <sub>(ë¸Œë¼ìš°ì €)</sub>
```http
Access-Control-Allow-Origin: [*Â·í˜„ì¬ ì˜¤ë¦¬ì§„]
```

##### 3. `"use-credentials"`
- ì›ê²© ì„œë²„ í—¤ë” <sub>(2ê°œ)</sub> ì‘ë‹µ ì‹œ ì ‘ê·¼ í—ˆìš©
- ì¸ì¦ ì •ë³´ Â· ì¿ í‚¤ ì„œë²„ ì „ì†¡ <sub>(ë¸Œë¼ìš°ì €)</sub>
```http
Access-Control-Allow-Origin: í˜„ì¬ ì˜¤ë¦¬ì§„
Access-Control-Allow-Credentials: true
```

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **ì£¼ì˜**

##### [CORS](../../part3.%20Additional%20articles/03.%20Network%20requests/05.%20Cross-Origin%20Requests.md) <sub>(ì±•í„°)</sub> ì°¸ê³ 
- `fetch` <sub>(ë©”ì„œë“œ)</sub> ë„¤íŠ¸ì›Œí¬ ìš”ì²­
  - ë™ì¼ ì •ì±…

##### [ì¿ í‚¤](../../part3.%20Additional%20articles/04.%20Storing%20data%20in%20the%20browser/01.%20Cookies,%20document.cookie.md) <sub>(ì±•í„°)</sub> ì°¸ê³ 
- ì¿ í‚¤ ê´€ë ¨ ë‚´ìš©

<br />

##### `crossorigin="anonymous"` <sub>(ì†ì„±)</sub> ì„¤ì •
- ì›ê²© ì„œë²„ í•„ìš” í—¤ë” í•¨ê»˜ ì‘ë‹µ ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ ì ‘ê·¼ ê°€ëŠ¥
```html
<script>
  window.onerror = function(message, url, line, col, errorObj) {
    alert(`${message}\n${url}, ${line}:${col}`);
  };
  </script>
<script crossorigin="anonymous" src="https://cors.javascript.info/article/onload-onerror/crossorigin/error.js"></script>
```

<br />

ìš”ì•½
====

##### ë¦¬ì†ŒìŠ¤ <sub>(ì´ë¯¸ì§€ Â· ì™¸ë¶€ ìŠ¤íƒ€ì¼ Â· ìŠ¤í¬ë¦½íŠ¸ ë“±)</sub> ì´ë²¤íŠ¸ <sub>(ë¡œë”© ì¶”ì )</sub>
- `load`
  - ë¡œë“œ ì„±ê³µ ì‹œ ë°œìƒ
- `error`
  - ë¡œë“œ ì‹¤íŒ¨ ì‹œ ë°œìƒ
- `readystatechange`
  - ë“œë¬¼ê²Œ ì‚¬ìš©

##### `<iframe>` <sub>(ì˜ˆì™¸ Â· ì—­ì‚¬ì  ì´ìœ )</sub>
- `load` <sub>(ì´ë²¤íŠ¸)</sub>
  - ë¡œë“œ ì¢…ë£Œ ì‹œ ë°œìƒ <sub>(ì„±ê³µ Â· ì‹¤íŒ¨ ì—¬ë¶€ ë¬´ê´€)</sub>
- `error` <sub>(ì´ë²¤íŠ¸)</sub> ë¯¸ë°œìƒ

<br />

## <img src="../../images/commons/icons/circle-check-solid.svg" /> ê³¼ì œ

### ì½œë°± í•¨ê»˜ ì´ë¯¸ì§€ ë¡œë“œí•˜ê¸°

##### `<img>` <sub>(ìš”ì†Œ)</sub>
- `src` <sub>(ì†ì„±)</sub> ì„¤ì • ì‹œ ë¡œë“œ ì‹œì‘
- ë¬¸ì„œ ë‚´ ì¶”ê°€ ì‹œ ì¦‰ì‹œ í‘œì‹œ X
    - ì´ë¯¸ì§€ ë¡œë“œ <sub>(ë¸Œë¼ìš°ì €)</sub>

##### ì´ë¯¸ì§€ ì¦‰ì‹œ í‘œì‹œ ë°©ë²•
- `<img>` <sub>(ìš”ì†Œ)</sub> ë¯¸ë¦¬ ìƒì„± <sub>(`src` ì†ì„± ì„¤ì •)</sub>
  - ì´ë¯¸ì§€ ë¡œë“œ ì‹œì‘ Â· ìºì‹œ ì €ì¥
```javascript
let img = document.createElement('img');
img.src = 'my.jpg';
```
- ì´í›„ ë¬¸ì„œ ë‚´ í•´ë‹¹ ì´ë¯¸ì§€ ì¶”ê°€ ì‹œ
  - ì¦‰ì‹œ í‘œì‹œ

##### `preloadImages(sources, cb)` <sub>(í•¨ìˆ˜)</sub> ì‘ì„±
- `sources` <sub>(ë°°ì—´)</sub> ë‚´ ì´ë¯¸ì§€ ë¡œë“œ
- ì´ë¯¸ì§€ ì „ë¶€ ë¡œë“œ ì™„ë£Œ ì‹œ
  - `cb` <sub>(ì½œë°±)</sub> ì‹¤í–‰

##### ëª¨ë“  ì´ë¯¸ì§€ ë¡œë“œ í›„ ê²½ê³  ì°½ í‘œì‹œ
```javascript
function loaded() {
  alert("Images loaded");
}

preloadImages(["1.jpg", "2.jpg", "3.jpg"], loaded);
```

##### ë¡œë“œ ì—ëŸ¬
- ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ ê°€ì •
- ê° ì´ë¯¸ì§€
  - ë¡œë“œ ì™„ë£Œ Â· ì—ëŸ¬ ë°œìƒ

##### ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ ì‘ì„± ì‹œ ìš©ì´
- ë‹¤ìˆ˜ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ ì´ë¯¸ì§€ æœ‰
- ëª¨ë“  ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ ë³´ì¥ í•„ìš”

<br />

<img src="../../images/commons/icons/circle-answer.svg" />

1. Make img for every source.
2. Add onload/onerror for every image.
3. Increase the counter when either onload or onerror triggers.
4. When the counter value equals to the sources count â€“ weâ€™re done: callback().

##### ì•Œê³ ë¦¬ì¦˜
1. ëª¨ë“  ì´ë¯¸ì§€ ì†ŒìŠ¤ <sub>(`sources` ë°°ì—´)</sub>
    - `img` <sub>(ìš”ì†Œ)</sub> ìƒì„±
2. ê° `img` <sub>(ìš”ì†Œ)</sub>
    - `on[loadÂ·error]` <sub>(í•¸ë“¤ëŸ¬)</sub> ì„¤ì •
3. `[loadÂ·error]` <sub>(ì´ë²¤íŠ¸)</sub> ë°œìƒ ì‹œ
    - ì¹´ìš´í„° ì¦ê°€
4. ì¹´ìš´í„° ê°’ == `sources` <sub>(ë°°ì—´)</sub> ìš”ì†Œ ê°œìˆ˜
    - `cb` <sub>(ì½œë°±)</sub> í˜¸ì¶œ

[ì •ë‹µ](https://plnkr.co/edit/M0qVEmqZnmYnFVIT?p=preview)
