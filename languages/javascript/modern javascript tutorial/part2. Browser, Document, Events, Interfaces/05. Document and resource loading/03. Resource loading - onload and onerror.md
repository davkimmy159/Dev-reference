`on[loadÂ·error]` <sub>(ë¦¬ì†ŒìŠ¤ ë¡œë”©)</sub>
====

##### ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ë¡œë”© ì¶”ì  ê°€ëŠ¥ <sub>(ë¸Œë¼ìš°ì €)</sub>
- ìŠ¤í¬ë¦½íŠ¸
- `iframe` <sub>(ìš”ì†Œ)</sub>
- ì´ë¯¸ì§€
- ê¸°íƒ€ ë“±ë“±

##### ê´€ë ¨ ì´ë²¤íŠ¸
- `load`
  - ë¦¬ì†ŒìŠ¤ ë¡œë“œ ì„±ê³µ
- `error`
  - ë¦¬ì†ŒìŠ¤ ë¡œë“œ ì‹¤íŒ¨

### ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ

##### ì„œë“œíŒŒí‹° ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
- ìŠ¤í¬ë¦½íŠ¸ ë‚´ í•¨ìˆ˜
  - ë¡œë“œ ì™„ë£Œ ì‹œ í˜¸ì¶œ ê°€ëŠ¥
```javascript
let script = document.createElement('script');
script.src = "my.js";

document.head.append(script);
```

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **ì£¼ì˜**

##### JS ëª¨ë“ˆ
- ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¯¸ì§€ì› ê°€ëŠ¥ì„± æœ‰

<br />

#### `load` <sub>(ì´ë²¤íŠ¸)</sub>

##### `<script>` <sub>(ìš”ì†Œ)</sub> ë°œìƒ
- `onload` <sub>(í”„ë¡œí¼í‹°)</sub>

##### ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ Â· ì‹¤í–‰ í›„ ë°œìƒ
```javascript
let script = document.createElement('script');
script.src = "https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js";

document.head.append(script);

// í•¸ë“¤ëŸ¬ ì„¤ì •
// - ìŠ¤í¬ë¦½íŠ¸ ë‚´ ë³€ìˆ˜ Â· í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥
script.onload = function() {

  // lodash (ë¼ì´ë¸ŒëŸ¬ë¦¬) ìŠ¤í¬ë¦½íŠ¸
  // - `_` (ë³€ìˆ˜) ìƒì„±
  alert( _.VERSION ); // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „
};
```

#### `error` <sub>(ì´ë²¤íŠ¸)</sub>

##### `<script>` <sub>(ìš”ì†Œ)</sub> ë°œìƒ
- `onerror` <sub>(í”„ë¡œí¼í‹°)</sub>

##### ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ë°œìƒ
- `404` ì—ëŸ¬ <sub>(ìŠ¤í¬ë¦½íŠ¸ ë¶€ì¬)</sub>
- ì„œë²„ ë¬¸ì œ ë°œìƒ <sub>(ì‚¬ìš© ë¶ˆê°€ëŠ¥)</sub>
- ê¸°íƒ€ ë“±ë“±

##### HTTP ì—ëŸ¬ ìƒì„¸ ì •ë³´ ë¯¸í¬í•¨
- ë¡œë“œ ì‹¤íŒ¨ ì—¬ë¶€ë§Œ í™•ì¸

##### `404` ì—ëŸ¬ <sub>(ë¶€ì¬ ìŠ¤í¬ë¦½íŠ¸ ìš”ì²­)</sub>
```javascript
let script = document.createElement('script');

// ë¶€ì¬ ìŠ¤í¬ë¦½íŠ¸
script.src = "https://example.com/404.js";

document.head.append(script);

// í•¸ë“¤ëŸ¬ ì„¤ì •
script.onerror = function() {

  // Error loading https://example.com/404.js
  alert("Error loading " + this.src);
};
```

<br />

<img src="../../images/commons/icons/triangle-exclamation-solid.svg" /> **ì¤‘ìš”**

##### `load` Â· `error` <sub>(ì´ë²¤íŠ¸)</sub>
- ë¡œë“œ ì™¸ ì¶”ì  X
  - ì˜¤ë¥˜
  - ì‹¤í–‰
  - ê¸°íƒ€ ë“±ë“±

##### `load` <sub>(ì´ë²¤íŠ¸)</sub>
- ë¡œë“œ ì™„ë£Œ ì‹œ ë°œìƒ
  - ìŠ¤í¬ë¦½íŠ¸ ë‚´ ì—ëŸ¬ ì—¬ë¶€ ë¬´ê´€
- `window.onerror` <sub>(ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬)</sub>
  - ìŠ¤í¬ë¦½íŠ¸ ë‚´ ì—ëŸ¬ ì¶”ì  ê°€ëŠ¥

<br />

### ê¸°íƒ€ ë¦¬ì†ŒìŠ¤

##### `load` Â· `error` <sub>(ì´ë²¤íŠ¸)</sub>
- ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ <sub>(`src` ì†ì„±)</sub> ìš”ì†Œ ë°œìƒ
```javascript
let img = document.createElement('img');

// ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ì„¤ì • (src ì†ì„±)
img.src = "https://js.cx/clipart/train.gif";

img.onload = function() {
  alert(`Image loaded, size ${img.width}x${img.height}`);
};

img.onerror = function() {
  alert("Error occurred while loading image");
};
```

#### íŠ¹ì§• <sub>(ì—­ì‚¬ì  ì´ìœ )</sub>

##### ëŒ€ë‹¤ìˆ˜ ë¦¬ì†ŒìŠ¤ <sub>(ìš”ì†Œ)</sub>
- ë¬¸ì„œ ë‚´ ì¶”ê°€ ì‹œ ë¡œë“œ ì‹œì‘

##### `<img>` <sub>(ìš”ì†Œ)</sub>
- `src` <sub>(ì†ì„±)</sub> ì„¤ì • ì‹œ ë¡œë“œ ì‹œì‘

##### `<iframe>` <sub>(ìš”ì†Œ)</sub>
- `load` <sub>(ì´ë²¤íŠ¸)</sub>
  - ë¡œë“œ ì¢…ë£Œ ì‹œ ë°œìƒ <sub>(ì„±ê³µ Â· ì‹¤íŒ¨ ì—¬ë¶€ ë¬´ê´€)</sub>

### í¬ë¡œìŠ¤ ì˜¤ë¦¬ì§„ ì •ì±…

Thereâ€™s a rule: scripts from one site canâ€™t access contents of the other site. So, e.g. a script at `https://facebook.com` canâ€™t read the userâ€™s mailbox at `https://gmail.com`.

Or, to be more precise, one origin (domain/port/protocol triplet) canâ€™t access the content from another one. So even if we have a subdomain, or just another port, these are different origins with no access to each other.

This rule also affects resources from other domains.

If weâ€™re using a script from another domain, and thereâ€™s an error in it, we canâ€™t get error details.

##### ì˜¤ë¦¬ì§„ <sub>(ë„ë©”ì¸ Â· í¬íŠ¸ Â· í”„ë¡œí† ì½œ)</sub> ê·œì¹™
- ìƒì´ ì˜¤ë¦¬ì§„ ë‚´ìš© ì ‘ê·¼ X
- ex\) `https://facebook.com` <sub>(ë‚´ë¶€ ìŠ¤í¬ë¦½íŠ¸)</sub>
  - `https://gmail.com` ë©”ì¼ ì ‘ê·¼ ë¶ˆê°€ëŠ¥
- í•œ ì˜¤ë¦¬ì§„
  - ìƒì´ ì˜¤ë¦¬ì§„ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ X
- ìƒì´ ì˜¤ë¦¬ì§„ ë‚´ ìŠ¤í¬ë¦½íŠ¸ <sub>(ì—ëŸ¬ ë°œìƒ)</sub> ì‚¬ìš© ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ ì ‘ê·¼ X

##### `error.js` <sub>(ìŠ¤í¬ë¦½íŠ¸)</sub>
- ì˜ëª»ëœ í•¨ìˆ˜ í˜¸ì¶œ êµ¬í˜„
```javascript
/* ğŸ“ error.js */
noSuchFunction();
```
- ë™ì¼ ì‚¬ì´íŠ¸ ë‚´ í•¨ìˆ˜ <sub>(`error.js`)</sub> í˜¸ì¶œ ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ í‘œì‹œ
```html
<script>
window.onerror = function(message, url, line, col, errorObj) {
  alert(`${message}\n${url}, ${line}:${col}`);
};
</script>
<script src="/article/onload-onerror/crossorigin/error.js"></script>
```
```
Uncaught ReferenceError: noSuchFunction is not defined
https://javascript.info/article/onload-onerror/crossorigin/error.js, 1:1
```
- íƒ€ ë„ë©”ì¸ ë‚´ í•¨ìˆ˜ <sub>(`error.js`)</sub> í˜¸ì¶œ ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ X <sub>(ë¸Œë¼ìš°ì €ë³„ ë‚´ìš© ìƒì´)</sub>
```html
<script>
window.onerror = function(message, url, line, col, errorObj) {
  alert(`${message}\n${url}, ${line}:${col}`);
};
</script>
<script src="https://cors.javascript.info/article/onload-onerror/crossorigin/error.js"></script>
```
```
Script error.
, 0:0
```

##### ìˆ˜ë§ì€ ì„œë¹„ìŠ¤
- ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬ <sub>(`window.onerror`)</sub>
- ì—ëŸ¬ ì €ì¥
- ì¸í„°í˜ì´ìŠ¤ ì œê³µ
  - ì—ëŸ¬ ì ‘ê·¼ Â· ë¶„ì„
- ì‹¤ì œ ì‚¬ìš©ì ìœ ë°œ ì—ëŸ¬
  - ë¶„ì„ Â· ì²˜ë¦¬ Â· ëŒ€ì‘

##### ìƒì´ ì˜¤ë¦¬ì§„ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ì‹œ
- ì—ëŸ¬ ë‚´ ìƒì œ ì •ë³´ X
  - ì—ëŸ¬ ë¶„ì„ Â· ì²˜ë¦¬ X

##### ê¸°íƒ€ ë¦¬ì†ŒìŠ¤
- ë™ì¼ ê·œì¹™ ì ìš©

#### í¬ë¡œìŠ¤ ì˜¤ë¦¬ì§„ ì ‘ê·¼ í—ˆìš© ë°©ë²•
- `<script>` <sub>(íƒœê·¸)</sub>
  - `crossorigin` <sub>(ì†ì„±)</sub> ì„¤ì •
- ì›ê²© ì„œë²„
  - íŠ¹ìˆ˜ í—¤ë” ì œê³µ

#### ì„¤ì • <sub>(3ê°€ì§€)</sub>

##### 1. `crossorigin` <sub>(ì†ì„±)</sub> X
- ì ‘ê·¼ ê±°ì ˆ

##### 2. `crossorigin="anonymous"`
- ì›ê²© ì„œë²„ í—¤ë” ì‘ë‹µ ì‹œ
  - ì ‘ê·¼ í—ˆìš©
```javascript
Access-Control-Allow-Origin: [*Â·ì˜¤ë¦¬ì§„]
```
- ë¸Œë¼ìš°ì € â†’ ì›ê²© ì„œë²„
  - í—ˆê°€ ì •ë³´ Â· ì¿ í‚¤ ë¯¸ì „ì†¡

##### 3. `crossorigin="use-credentials"`
- ì›ê²© ì„œë²„ í—¤ë” <sub>(2ê°œ)</sub> ì‘ë‹µ ì‹œ
  - ì ‘ê·¼ í—ˆìš©
```javascript
Access-Control-Allow-Origin: ì˜¤ë¦¬ì§„
Access-Control-Allow-Credentials: true
```
- ë¸Œë¼ìš°ì € â†’ ì›ê²© ì„œë²„
  - í—ˆê°€ ì •ë³´ Â· ì¿ í‚¤ ì „ì†¡

<br />

<img src="../../images/commons/icons/circle-exclamation-solid.svg" /> **ì£¼ì˜**

##### [CORS](../../part3.%20Additional%20articles/03.%20Network%20requests/05.%20Cross-Origin%20Requests.md) <sub>(ì±•í„°)</sub> ì°¸ê³ 
- `fetch` <sub>(ë©”ì„œë“œ)</sub> ì„¤ëª…
  - ë„¤íŠ¸ì›Œí¬ ìš”ì²­ <sub>(ë™ì¼ ì •ì±…)</sub>

##### [ì¿ í‚¤](../../part3.%20Additional%20articles/04.%20Storing%20data%20in%20the%20browser/01.%20Cookies,%20document.cookie.md) <sub>(ì±•í„°)</sub> ì°¸ê³ 
- ì¿ í‚¤ ê´€ë ¨ ë‚´ìš©
<br />

##### `crossorigin` <sub>(ì†ì„±)</sub> ì„¤ì •ê°’ <sub>(2ê°€ì§€)</sub>
- `"anonymous"`
  - ì¿ í‚¤ ë¯¸ì „ì†¡
  - ì‘ë‹µ í—¤ë” 1ê°œ í•„ìš”
- `"use-credentials"`
  - ì¿ í‚¤ ì „ì†¡
  - ì‘ë‹µ í—¤ë” 2ê°œ í•„ìš”

##### `crossorigin="anonymous"` <sub>(ì†ì„±)</sub> ì„¤ì •
- ì›ê²© ì„œë²„ í•„ìš” í—¤ë” í•¨ê»˜ ì‘ë‹µ ì‹œ
  - ì—ëŸ¬ ìƒì„¸ ì •ë³´ ì ‘ê·¼ ê°€ëŠ¥
```html
<script>
window.onerror = function(message, url, line, col, errorObj) {
  alert(`${message}\n${url}, ${line}:${col}`);
};
</script>
<script crossorigin="anonymous" src="https://cors.javascript.info/article/onload-onerror/crossorigin/error.js"></script>
```

<br />

ìš”ì•½
====

##### ë¦¬ì†ŒìŠ¤ <sub>(ì´ë¯¸ì§€ Â· ì™¸ë¶€ ìŠ¤íƒ€ì¼ Â· ìŠ¤í¬ë¦½íŠ¸ ë“±)</sub> ì´ë²¤íŠ¸ <sub>(ë¡œë”© ì¶”ì )</sub>
- `load` <sub>(ì´ë²¤íŠ¸)</sub>
  - ë¡œë“œ ì„±ê³µ ì‹œ ë°œìƒ
- `error` <sub>(ì´ë²¤íŠ¸)</sub>
  - ë¡œë“œ ì‹¤íŒ¨ ì‹œ ë°œìƒ
- `readystatechange` <sub>(ì´ë²¤íŠ¸)</sub>
  - ë“œë¬¼ê²Œ ì‚¬ìš©

##### `<iframe>` <sub>(ì˜ˆì™¸ Â· ì—­ì‚¬ì  ì´ìœ )</sub>
- ë¡œë“œ ì™„ë£Œ Â· ì‹¤íŒ¨ ì‹œ ë°œìƒ

<br />

## <img src="../../images/commons/icons/circle-check-solid.svg" /> ê³¼ì œ

### ì½œë°± í•¨ê»˜ ì´ë¯¸ì§€ ë¡œë“œí•˜ê¸°

##### ì´ë¯¸ì§€ ë¡œë“œ
- `<img>` <sub>(ìš”ì†Œ)</sub> ë‚´ `src` <sub>(ì†ì„±)</sub> ì„¤ì • ì‹œ
  - ë¡œë“œ ì‹œì‘
- ë¬¸ì„œ ë‚´ ì´ë¯¸ì§€ ì¶”ê°€ ì‹œ ì¦‰ì‹œ í‘œì‹œ X
    - ì´ë¯¸ì§€ ë¡œë“œ í•„ìš” <sub>(ë¸Œë¼ìš°ì €)</sub>

##### ì´ë¯¸ì§€ ì¦‰ì‹œ í‘œì‹œ ë°©ë²•
- `<img>` <sub>(ìš”ì†Œ)</sub> ë¯¸ë¦¬ ìƒì„± <sub>(`src` ì†ì„± ì„¤ì •)</sub>
  - ì´ë¯¸ì§€ ë¡œë“œ ì‹œì‘ Â· ìºì‹œ ì €ì¥
- ì´í›„ ë¬¸ì„œ ë‚´ ë™ì¼ ì´ë¯¸ì§€ ë“±ì¥ ì‹œ
  - ì¦‰ì‹œ í‘œì‹œ
```javascript
let img = document.createElement('img');
img.src = 'my.jpg';
```

##### `preloadImages(sources, cb)` <sub>(í•¨ìˆ˜)</sub> ì‘ì„±
- `sources` <sub>(ë°°ì—´)</sub> ë‚´ ì´ë¯¸ì§€ ë¡œë“œ
- ì „ë¶€ ë¡œë“œ ì™„ë£Œ ì‹œ
  - `cb` <sub>(ì½œë°±)</sub> ì‹¤í–‰

##### ëª¨ë“  ì´ë¯¸ì§€ ë¡œë“œ í›„ ì–¼ëŸ¿ì°½ í‘œì‹œ
```javascript
function loaded() {
  alert("Images loaded")
}

preloadImages(["1.jpg", "2.jpg", "3.jpg"], loaded);
```

##### `cb` <sub>(ì½œë°±)</sub>
- ì—ëŸ¬ ë°œìƒ ì‹œ
  - ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ ê°€ì •
- ëª¨ë“  ì´ë¯¸ì§€
  - ê°ê° ë¡œë“œ ì™„ë£Œ Â· ì˜¤ë¥˜ ë°œìƒ

##### ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ ì‘ì„± ì‹œ ìš©ì´
- ë‹¤ìˆ˜ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ ì´ë¯¸ì§€
- ëª¨ë“  ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ ë³´ì¥

<br />

<img src="../../images/commons/icons/circle-answer.svg" />

##### ì•Œê³ ë¦¬ì¦˜
1. ëª¨ë“  ì´ë¯¸ì§€ ì›ì²œ <sub>(`sources` ë°°ì—´)</sub>
    - `img` <sub>(ìš”ì†Œ)</sub> ìƒì„±
2. ê° `img` <sub>(ìš”ì†Œ)</sub>
    - `on[loadÂ·error]` í•¸ë“¤ëŸ¬ ì„¤ì •
3. `[loadÂ·error]` <sub>(ì´ë²¤íŠ¸)</sub> ë°œìƒ ì‹œ
    - ì¹´ìš´í„° ì¦ê°€
4. ì¹´ìš´í„° ê°’ == `sources` <sub>(ë°°ì—´)</sub> ìš”ì†Œ ê°œìˆ˜
    - `cb` <sub>(ì½œë°±)</sub> í˜¸ì¶œ

[ì •ë‹µ](https://plnkr.co/edit/M0qVEmqZnmYnFVIT?p=preview)
